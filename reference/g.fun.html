<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculates the invariants g2 and g3 — g.fun • elliptic</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates the invariants g2 and g3 — g.fun"><meta property="og:description" content="Calculates the invariants g2 and g3 using any of a number of methods"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">elliptic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RobinHankin/elliptic/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculates the invariants g2 and g3</h1>

    <div class="hidden name"><code>g.fun.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the invariants g2 and g3 using any of a number of methods</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">g.fun</span><span class="op">(</span><span class="va">b</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">g2.fun</span><span class="op">(</span><span class="va">b</span>, use.first<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">g3.fun</span><span class="op">(</span><span class="va">b</span>, use.first<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span><span class="fu">g2.fun.lambert</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span>, strict<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">g3.fun.lambert</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span>, strict<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">g2.fun.direct</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span><span class="op">)</span></span>
<span><span class="fu">g3.fun.direct</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span><span class="op">)</span></span>
<span><span class="fu">g2.fun.fixed</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span>, give<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">g3.fun.fixed</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span>, give<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">g2.fun.vectorized</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span>, give<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">g3.fun.vectorized</span><span class="op">(</span><span class="va">b</span>, nmax<span class="op">=</span><span class="fl">50</span>, tol<span class="op">=</span><span class="fl">1e-10</span>, give<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Half periods.  NB: the arguments
  are the <strong>half periods</strong> as per AMS55!
  In these functions, argument <code>b</code> is interpreted as per
  <code><a href="p1.tau.html">p1.tau()</a></code></p></dd>

<dt id="arg-nmax">nmax<a class="anchor" aria-label="anchor" href="#arg-nmax"></a></dt>
<dd><p>Maximum number of terms to sum.  See details section for
  more discussion</p></dd>

<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Numerical tolerance for stopping: summation stops when adding
  an additional term makes less</p></dd>

<dt id="arg-strict">strict<a class="anchor" aria-label="anchor" href="#arg-strict"></a></dt>
<dd><p>Boolean, with default (where taken) <code>TRUE</code> meaning to
  <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code> if convergence is not achieved in <code>nmax</code> terms.
  Setting to <code>FALSE</code> returns the partial sum and a warning.</p></dd>

<dt id="arg-give">give<a class="anchor" aria-label="anchor" href="#arg-give"></a></dt>
<dd><p>Boolean, with default (where taken) <code>TRUE</code> meaning to
  return the partial sums.  See examples section for an example of this
  argument in use</p></dd>

<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>In functions <code>g.fun()</code>, <code>g2.fun()</code> and
  <code>g3.fun()</code>, extra arguments passed to <code><a href="theta.html">theta1()</a></code> and friends</p></dd>

<dt id="arg-use-first">use.first<a class="anchor" aria-label="anchor" href="#arg-use-first"></a></dt>
<dd><p>In function <code>g2.fun()</code> and <code>g3.fun()</code>,
  Boolean with default <code>TRUE</code> meaning to use Wolfram's first formula
  (<strong>remember to cite this</strong>) and <code>FALSE</code> meaning to use the second</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Functions <code>g2.fun()</code> and <code>g3.fun()</code> use theta functions
  which converge very quickly.  These functions are the best in most
  circumstances.  The theta functions include a loop that continues to add
  terms until the partial sum is unaltered by addition
  of the next term.  Note that summation continues until <em>all</em>
  elements of the argument are properly summed, so performance is
  limited by the single worst-case element.</p>
<p>The following functions are provided for interest only, although there
  is a remote possibility that some weird circumstances may exist in which
  they are faster than the theta function approach.</p>
<p>Functions <code>g2.fun.divisor()</code> and <code>g3.fun.divisor()</code> use
  Chandrasekharan's formula on page 83.  This is generally slower than
  the theta function approach</p>
<p>Functions <code>g2.fun.lambert()</code> and <code>g3.fun.lambert()</code> use a
  Lambert series to accelerate Chandrasekharan's formula.  In general,
  it is a little better than the divisor form.</p>
<p>Functions <code>g2.fun.fixed()</code> and <code>g2.fun.fixed()</code> also use
  Lambert series.  These functions are vectorized in the sense that
  the function body uses only vector operations.  These functions do
  not take a vector argument.  They are called “fixed” because
  the number of terms used is fixed in advance (unlike <code>g2.fun()</code>
  and <code>g3.fun()</code>).</p>
<p>Functions <code>g2.fun.vectorized()</code> and <code>g3.fun.vectorized()</code>
  also use Lambert series.  They are fully vectorized in that they take
  a vector of periods or period ratios, unlike the previous two
  functions.  However, this can lead to loss of precision in some
  cases (specifically when the periods give rise to widely varying
  values of g2 and g3).</p>
<p>Functions <code>g2.fun.direct()</code> and <code>g3.fun.direct()</code> use a
  direct summation.  These functions are absurdly slow.  In general,
  the Lambert series functions converge much faster; and the
  “default” functions <code>g2.fun()</code> and <code>g3.fun()</code>,
  which use theta functions, converge faster still.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Mathematica website</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Robin K. S. Hankin</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">g.fun</span><span class="op">(</span><span class="fu"><a href="half.periods.html">half.periods</a></span><span class="op">(</span>g<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">4</span><span class="op">+</span><span class="fl">1i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co">## should be c(8,4+1i)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              g2              g3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8-1.887379e-15i 4+1.000000e+00i</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4, p664, LHS:</span></span></span>
<span class="r-in"><span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">11i</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">g2.fun</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001007577+0i</span>
<span class="r-in"><span><span class="op">(</span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu">g3.fun</span><span class="op">(</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.14201e-06+0i</span>
<span class="r-in"><span><span class="fu"><a href="e1e2e3.html">e1e2e3</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">g2</span>,<span class="va">g3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           e1           e2           e3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.016843041 -0.002166258 -0.014676784 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4, p664, RHS:</span></span></span>
<span class="r-in"><span><span class="va">omega2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">omega2dash</span> <span class="op">&lt;-</span> <span class="fl">11i</span></span></span>
<span class="r-in"><span><span class="va">omega1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">omega2</span><span class="op">-</span><span class="va">omega2dash</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>   <span class="co">## From figure 18.1, p630</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu">g2.fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">omega1</span>,<span class="va">omega2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.003748749+7.589415e-19i</span>
<span class="r-in"><span><span class="op">(</span><span class="va">g3</span> <span class="op">&lt;-</span> <span class="fu">g3.fun</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">omega1</span>,<span class="va">omega2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.656681e-05-8.470329e-22i</span>
<span class="r-in"><span><span class="fu"><a href="e1e2e3.html">e1e2e3</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">g2</span>,<span class="va">g3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       e1                       e2                       e3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.002166258+0.03084259i  0.004332515+0.00000000i -0.002166258-0.03084259i</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

